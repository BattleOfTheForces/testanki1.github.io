window.addEventListener("load",function(){var hideRecentChanges=!1;var el=document.getElementById("mw-content-text");var hiddenPages=["Test"];if(mw.config.values.wgTitle==="RecentChanges"&&hideRecentChanges===false||hiddenPages.indexOf(mw.config.values.wgTitle)!==-1){if(mw.config.values.wgUserGroups.indexOf("administrator")!==-1||mw.config.values.wgUserGroups.indexOf("bureaucrat")!==-1||mw.config.values.wgUserGroups.indexOf("user")!==-1){el.style.display="block";}else{el.parentNode.removeChild(el);}}var isWikiEditor=!1;if(mw.config.values.wgUserName!=null){isWikiEditor=!0;}if(isWikiEditor==true){mw.loader.load("https://commons.wikimedia.org/w/index.php?title=MediaWiki:Gadget-HotCat.js&oldid=211134664&action=raw&ctype=text/javascript");}var testing=!1;var testers=["Hexed"];if(isWikiEditor==true&&testers.indexOf(mw.config.values.wgUserName)!==-1&&testing==true){mw.loader.load("https://testanki1.github.io/tankiwiki/MediaWiki:Test.css?action=raw&ctype=text/css","text/css");mw.loader.load(

"https://testanki1.github.io/tankiwiki/MediaWiki:Test.js?action=raw&ctype=text/javascript");}if(!Object.keys)Object.keys=function(o){if(o!==Object(o))throw new TypeError('Object.keys called on a non-object');var k=[],p;for(p in o)if(Object.prototype.hasOwnProperty.call(o,p))k.push(p);return k;}

function getRandomKey(obj){var keys=Object.keys(obj);return keys[Math.floor(Math.random()*keys.length)];};function getRandomVal(obj){return obj[getRandomKey(obj)];};function getSplitNumber(num){return num.toString().replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,'$1 ');}function getSelectedText(){if(window.getSelection){return window.getSelection().toString();}else if(document.getSelection){return document.getSelection().toString();}else if(document.selection){return document.selection.createRange().text;}else{return false;}}function isNotEmpty(_var){return!(_var==""||new RegExp(/^\s+$/).test(_var)||_var==null||_var==[]||_var=={});}function isDesktopChrome(){var ua=window.navigator.userAgent.toLowerCase();return(window.navigator.vendor.toLowerCase().indexOf("google")>-1&&window.chrome!=null&&ua.indexOf("opr")==-1&&ua.indexOf("opera")==-1&&ua.indexOf("yabrowser")==-1&&ua.indexOf("yowser")==-1&&ua.indexOf("edge")==-1&&ua.indexOf("android")==-1&&ua.indexOf("crios")==-1);}(function(root,factory){if

(typeof define==='function'&&define.amd){define(factory);}else if(typeof exports==='object'){module.exports=factory();}else{root.tingle=factory();}}(this,function(){function Modal(options){var defaults={onClose:null,onOpen:null,beforeOpen:null,beforeClose:null,closeMethods:['overlay','button','escape'],cssClass:[]};this.opts=extend({},defaults,options);this.init();}Modal.prototype.init=function(){if(this.modal){return;}_build.call(this);_bindEvents.call(this);document.body.appendChild(this.modal);};Modal.prototype.destroy=function(){if(this.modal===null){return;}_unbindEvents.call(this);this.modal.parentNode.removeChild(this.modal);this.modal=null;};Modal.prototype.open=function(){var self=this;if(typeof self.opts.beforeOpen==='function'){self.opts.beforeOpen();}if(this.modal.style.removeProperty){this.modal.style.removeProperty('display');}else{this.modal.style.removeAttribute('display');}_addClass(document.body,'tingle-enabled');_addClass(this.modal,'tingle-modal--visible');if(typeof

self.opts.onOpen==='function'){self.opts.onOpen.call(self);}this.checkOverflow();};Modal.prototype.isOpen=function(){return this.modal?_hasClass(this.modal,"tingle-modal--visible"):!1;};Modal.prototype.close=function(){if(typeof this.opts.beforeClose==="function"){var close=this.opts.beforeClose.call(this);if(!close){return;}}var self=this;jQuery(this.modal).fadeOut(200,function(){_removeClass(document.body,'tingle-enabled');_removeClass(this,'tingle-modal--visible');self.modal.style.display='none';if(typeof self.opts.onClose==="function"){self.opts.onClose.call(this);}self.destroy();});};Modal.prototype.setContent=function(content){if(typeof content==='string'){this.modalBoxContent.innerHTML=content;}else{this.modalBoxContent.innerHTML="";this.modalBoxContent.appendChild(content);}};Modal.prototype.getContent=function(){return this.modalBoxContent;};Modal.prototype.isOverflow=function(){return this.modalBox.clientHeight>=window.innerHeight;};Modal.prototype.checkOverflow=function()

{if(_hasClass(this.modal,'tingle-modal--visible')){if(this.isOverflow()){_addClass(this.modal,'tingle-modal--overflow');}else{_removeClass(this.modal,'tingle-modal--overflow');}}}

function _build(){this.modal=document.createElement('div');_addClass(this.modal,'tingle-modal');this.modal.style.display='none';this.opts.cssClass.forEach(function(item){if(typeof item==='string'){_addClass(this.modal,item);}},this);this.modalCloseBtnIcon=document.createElement('button');_addClass(this.modalCloseBtnIcon,'tingle-modal__closeIcon');_addClass(this.modalCloseBtnIcon,'tingle-modal__close');this.modalBox=document.createElement('div');_addClass(this.modalBox,'tingle-modal-box');this.modalBoxContent=document.createElement('div');_addClass(this.modalBoxContent,'tingle-modal-box__content');this.modalBox.appendChild(this.modalBoxContent);this.modal.appendChild(this.modalCloseBtnIcon);this.modal.appendChild(this.modalBox);}function _bindEvents(){this._events={clickCloseBtn:this.close.bind(this),clickOverlay:_handleClickOutside.bind(this),resize:this.checkOverflow.bind(this),keyboardNav:_handleKeyboardNav.bind(this)};this.modalCloseBtnIcon.addEventListener('click',this._events.

clickCloseBtn);this.modal.addEventListener('mousedown',this._events.clickOverlay);window.addEventListener('resize',this._events.resize);document.addEventListener("keydown",this._events.keyboardNav);}function _handleKeyboardNav(event){if(event.which===27&&this.isOpen()){this.close();}}function _handleClickOutside(event){if(this.opts.closeMethods.indexOf('overlay')!==-1&&!_findAncestor(event.target,'tingle-modal')&&event.clientX<this.modal.clientWidth){this.close();}}function _findAncestor(el,cls){while((el=el.parentElement)&&!_hasClass(el,cls));return el;}function _unbindEvents(){this.modalCloseBtnIcon.removeEventListener('click',this._events.clickCloseBtn);this.modal.removeEventListener('mousedown',this._events.clickOverlay);window.removeEventListener('resize',this._events.resize);document.removeEventListener("keydown",this._events.keyboardNav);}function _cleanClassName(target){target.className=target.className.replace(/[\n\t]/g," ").trim();}function _hasClass(target,classname){

_cleanClassName(target);return!!((" "+target.className+" ").indexOf(" "+classname.trim()+" ")>-1);}function _addClass(target,classname){if(!_hasClass(target,classname)){target.className+=' '+classname.trim();}}function _removeClass(target,classname){if(_hasClass(target,classname)){var regexp=new RegExp('(\\s|^)'+classname.trim()+'(\\s|$)');target.className=target.className.replace(regexp,' ').trim();}}function extend(){for(var i=1;i<arguments.length;i++){for(var key in arguments[i]){if(arguments[i].hasOwnProperty(key)){arguments[0][key]=arguments[i][key];}}}return arguments[0];}return{modal:Modal};}));!function(e,t,a,n,c,m,r){e.ym=e.ym||function(){(e.ym.a=e.ym.a||[]).push(arguments)},e.ym.l=1*new Date,m=t.createElement(a),r=t.getElementsByTagName(a)[0],m.async=1,m.src="https://mc.yandex.ru/metrika/tag.js",r.parentNode.insertBefore(m,r)}(window,document,"script"),ym(79202932,"init",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0});jQuery.noConflict();jQuery(document).ready(function($)

{$('body').append('<div id="toTop-wrapper" style="display: none;"><div id="toTop-arrow"></div></div>');$(function(){$(window).scroll(function(){if($(this).scrollTop()>500){$('#toTop-wrapper').fadeIn(300);}else{$('#toTop-wrapper').fadeOut(100);}});$('#toTop-wrapper').click(function(){$('body,html').animate({scrollTop:0},200);});});if($("#HomepageDropdowns").length){var ddl=$(".drop-down-list");$(document).on('click','.drop-down-block',function(){for(var i=0;i<ddl.length;i++){if(ddl[i]==($(this).next().find('.drop-down-list'))[0]){$(ddl[i]).parent().prev().toggleClass("rotate180");$(ddl[i]).slideToggle();}else{$(ddl[i]).parent().prev().toggleClass("rotate180",false);$(ddl[i]).hide();}}});$(document).click(function(event){if(!$(event.target).hasClass('drop-down-list')&&!$(event.target).parent().hasClass('drop-down-list')&&!$(event.target).parent().parent().hasClass('drop-down-list')&&!$(event.target).parent().hasClass('drop-down-block')&&!$(event.target).hasClass('drop-down-block')&&!$(

event.target).hasClass('drop-down-list-wrapper')){for(var j=0;j<ddl.length;j++){if($(ddl[j]).is(":visible")){$(ddl[j]).parent().prev().toggleClass("rotate180",false);$(ddl[j]).slideUp("fast");}}}});}if($(".mapScreenshotsCarousel").length){$('.mapScreenshotsCarousel .carouselContainer').remove();$.each($(".mapScreenshotsCarousel .open"),function(k,v){$($(v).children()).detach().insertAfter($(v));});}if($('.showPaint').length){var parts_url='images/en/6/66/Tank_parts_resources.json?v=017';var paints_url='images/en/6/6d/Paints_textures.json?v=019';var swfobject_url='https://cdnjs.cloudflare.com/ajax/libs/swfobject/2.2/swfobject.min.js';var Viewer={currentPaint:null,data:{},emptyTank:function(){return{"hull":{"type":null,"model":null},"turret":{"type":null,"model":null},"paint":{"type":null,"model":null}};},getRandomTank:function(){var tank=this.emptyTank();if(isNotEmpty(this.data)){tank.hull.type=getRandomKey(this.data.hulls);tank.turret.type=getRandomKey(this.data.turrets);tank.hull.

model=getRandomKey(this.data.hulls[tank.hull.type]);tank.turret.model=getRandomKey(this.data.turrets[tank.turret.type]);return tank;}else{return false;}},appendViewer:function(tank,target_id){if(swfobject){swfobject.ua.pv=[100,0,0];var viewer_swf='images/en/2/24/Tank_viewer.swf';var items={"hull":this.data.hulls[tank.hull.type][tank.hull.model],"turret":this.data.turrets[tank.turret.type][tank.turret.model],"paint":this.data.paints[tank.paint.type][tank.paint.model]};var flashvars={"itemsXml":"<response>"+"<hull_model>"+items.hull.model+"</hull_model>"+"<hull_details>"+items.hull.details+"</hull_details>"+"<hull_details_alpha>"+items.hull.alpha+"</hull_details_alpha>"+"<hull_lightmap>"+items.hull.lightmap+"</hull_lightmap>"+"<turret_model>"+items.turret.model+"</turret_model>"+"<turret_details>"+items.turret.details+"</turret_details>"+"<turret_details_alpha>"+items.turret.alpha+"</turret_details_alpha>"+"<turret_lightmap>"+items.turret.lightmap+"</turret_lightmap>"+"<paint_texture>"+

items.paint+"</paint_texture>"+"</response>"};var params={"menu":!1,"seamlesstabbing":!1,"wmode":"transparent"}

swfobject.embedSWF(viewer_swf,target_id,"600","400","11",false,flashvars,params,false);}else{return false;}}};$.when($.getJSON(parts_url,function(json){Viewer.data.hulls=json.hulls;Viewer.data.turrets=json.turrets;}),$.getJSON(paints_url,function(json){Viewer.data.paints=json;}),$.getScript(swfobject_url)).done(function(){var templateMenu=['<div class="report-head"><div class="report-title">Preview on a tank</div><div class="report-stripes"></div><div class="report-close"></div></div></div>','<div id="TankPreview__wrapper">',' <div id="TankPreview__viewer"><div id="TankPreview"></div></div>',' <div id="TankPreview__controls">','   <div class="wrapper">','         Hull:','         <select class="html5-control" size="1" id="hullType" name="hullType" data-category="hulls" data-child="hullModel">','           <option selected hidden disabled value="title">Model</option>','         </select>',

'         <select class="html5-control" disabled size="1" id="hullModel" name="hullModel" data-parent="hullType">','           <option selected hidden disabled value="title">Grade</option>','         </select>',,'     </div>','   <div class="wrapper">','         Turret:','         <select class="html5-control" size="1" id="turretType" name="turretType" data-category="turrets" data-child="turretModel">','           <option selected hidden disabled value="title">Model</option>','         </select>','         <select class="html5-control" disabled size="1" id="turretModel" name="turretModel" data-parent="turretType">','           <option selected hidden disabled value="title">Grade</option>','         </select>','   </div>','   <button class="html5-control" id="showTank" disabled>Show</button>',' </div>','</div>'].join('\n');var modal=null;var embedded_id='TankPreview';function fillDropdown(id,isParent){var _select=$("#"+id);_select.empty();var $keys;if(isParent){_select.append($(

'<option selected hidden disabled value="title">Model</option>'));$keys=$(Object.keys(Viewer.data[_select.data("category")]));}else{_select.append($('<option selected hidden disabled value="title">Grade</option>'));var _parent=$("#"+_select.data("parent"));var key=_parent.find("option:selected").val();$keys=$(Object.keys(Viewer.data[_parent.data("category")][key]));}$keys.each(function(k,v){_select.append($('<option value="'+v+'">'+v+'</option>'));});}function onTypeChanged(){var childId=$(this).data("child");fillDropdown(childId,false);$("#"+childId).removeAttr("disabled");}function onSelectedChanged(){var flag=!1;$("#TankPreview__controls select").each(function(i,el){flag=flag||($(el).children(":selected").val()=="title");});if(flag){$("#showTank").attr("disabled","disabled");}else{$("#showTank").removeAttr("disabled");}}function showTank(){var tank=Viewer.emptyTank();tank.hull.type=$("#hullType option:selected").val();tank.turret.type=$("#turretType option:selected").val();tank.

hull.model=$("#hullModel option:selected").val();tank.turret.model=$("#turretModel option:selected").val();tank.paint.type=Viewer.currentPaint.type;tank.paint.model=Viewer.currentPaint.model;$("#TankPreview__viewer").empty().append('<div id="'+embedded_id+'"></div>');Viewer.appendViewer(tank,embedded_id);}function showTankPreviewModal(tank){modal=new tingle.modal({closeMethods:['button','escape','overlay'],onOpen:function(){fillDropdown("hullType",true);fillDropdown("turretType",true);$("#hullType, #turretType").change(onTypeChanged);$("#TankPreview__controls select").change(onSelectedChanged);if(isDesktopChrome()){$("#TankPreview").append('<a href="https://get.adobe.com/flashplayer">Enable Adobe Flash Player</a>');}$("#showTank").click(showTank);},beforeClose:function(){$("#hullType, #turretType").off('change');$("#TankPreview__controls select").off('change');$("#showTank").off('click');return true;}});modal.setContent(templateMenu);modal.open();$(".report-close").on("click",function(

){modal.close();});$(".tingle-modal__close").remove();Viewer.appendViewer(tank,embedded_id);}$('.showPaint').click(function(){Viewer.currentPaint={"type":$(this).data('paintType'),"model":$(this).data('paintModel')};var tank=Viewer.getRandomTank();tank.paint.type=Viewer.currentPaint.type;tank.paint.model=Viewer.currentPaint.model;showTankPreviewModal(tank);});});}if($(".pretty-spoiler").length){var texts={OPEN:"Reveal hidden contents",CLOSE:"Hide contents"};$('.pretty-spoiler > .title').click(function(){var content=$(this).next('div');changeTitleState($(this),content.is(":visible"));content.slideToggle(300);});function changeTitleState(elem,state){if(state){elem.css("background-color","rgba(255,255,255,0.1)");elem.prop('title',texts.OPEN);}else{elem.css("background-color","rgba(255,255,255,0.3)");elem.prop('title',texts.CLOSE);}elem.children('.title-arrow').toggleClass('rotate180');}}if($('.item-upgrades-block').length){var isMouseDown=!1;$('.item-upgrades-block').each(function(k,v)

{$(this).append('<div class="calc-mode"><div class="custom-checkbox"><input id="calc-cb_'+k+'" type="checkbox"><div class="checkbox-calc"></div><label for="calc-cb_'+k+'">Calculator mode</label></div><div class="discounts hidden" style="display: none;"><div class="calc-input-group"><label for="calc-discount-step_'+k+'"> Upgrade discount: </label><input type="number" pattern="[0-9]{1,2}" value="0" min="0" max="95" step="5" class="step" id="calc-discount-step_'+k+'" "></div><div class="calc-input-group"><label for="calc-discount-speed_'+k+'"> Speed-up discount: </label><input type="number" pattern="[0-9]{1,2}" value="0" min="0" max="95" step="5" class="speed" id="calc-discount-speed_'+k+'" "></div><button class="wiki-control grey-gradient reset" >Reset</button></div></div>');setInitial($(this).find('.item-upgrades-table'));});$(".item-upgrades-block input[type='checkbox']").change(function(){var parent=$(this).parents('.item-upgrades-block');var table=parent.find('.item-upgrades-table');

var inputs=parent.find('input[type="number"], input[type="text"]');if(this.checked){parent.find('.discounts').show();parent.find('.reset').on('click',function(){reset(parent,table,'soft');});inputs.on('change keyup input',function(){$(this).focus();applyDiscount(this,parent);$(this).focus();});table.find('.sum').show();$(['speed','delay','step']).each(function(k,v){var n=k+1;table.find("tr:not(.nocalc) td:nth-last-child("+n+")").on('mousedown',function(event){if(event.which==1||event.which==undefined)calculate(this,parent,v);if(event.which==1)isMouseDown=!0;return false;}).trigger('mousedown').on('mouseover',function(){if(isMouseDown)calculate(this,parent,v);return false;});});refreshSumAll(table);}else{parent.find('.reset').off('click');inputs.off('change');reset(parent,table,'hard');table.find('.sum').hide();parent.find('.discounts').hide();}});function calculate(_this,parent,type){var $this=$(_this);$this.toggleClass("highlighted");switch(type){case'step':var value=parseInt($this.

text());var td=parent.find('td.step');if($this.hasClass("highlighted")){td.text(parseInt(td.text())+value);}else{td.text(parseInt(td.text())-value);}refreshSumAll(parent);break;case'speed':var value=parseInt($this.text());var td=parent.find('td.speed');if($this.hasClass("highlighted")){td.text(parseInt(td.text())+value);}else{td.text(parseInt(td.text())-value);}refreshSumAll(parent);break;case'delay':var td=parent.find('td.delay');if($this.hasClass("highlighted")){td.text(getDelay(getMinutes(td.text())+getMinutes($this.text())));}else{td.text(getDelay(getMinutes(td.text())-getMinutes($this.text())));}break;}return false;};function applyDiscount(_this,parent){var $this=$(_this);var _val=$this.val();if(parseInt(_val)>95)$this.val(95);if(parseInt(_val.split('')[0])==0&&_val.length>1)$this.val(_val.split('')[1]);if(parseInt(_val)<0||isNaN(parseInt(_val)))$this.val(0);$this.prop('disabled',true);var type,tdSum;if($this.hasClass('step')){type=3;tdSum=parent.find('td.step');}else if($this.

hasClass('speed')){type=1;tdSum=parent.find('td.speed');}else return;var cells=parent.find('tr:not(.nocalc) td:nth-last-child('+type+')');var discount=parseFloat(((100-parseInt($this.val()))/100).toFixed(2));var sum=0;cells.each(function(){var cur=$(this);var initialValue=parseInt(cur.data('initial'));var newValue=Math.floor(initialValue*discount);cur.text(newValue);if(cur.hasClass('highlighted'))sum+=newValue;});tdSum.text(sum);refreshSumAll(parent);$this.prop('disabled',false);}function reset(parent,table,type){var cells=getCells(table);if(type=='hard'){cells.off('mousedown mouseover');}parent.find('.discounts input[type="number"]').val('0').text('');table.find('td.step').text('0');table.find('td.delay').text('0');table.find('td.speed').text('0');table.find('td.sumAll').text('0');cells.each(function(){$(this).removeClass('highlighted');$(this).text($(this).data('initial'));});}function getCells(table){return table.find("tr:not(.nocalc) td:nth-last-child(3),"+

"tr:not(.nocalc) td:nth-last-child(2), "+"tr:not(.nocalc) td:nth-last-child(1)");}function setInitial(table){getCells(table).each(function(){$(this).data('initial',$(this).text());});}function refreshSumAll(table){table.find('td.sumAll').html(parseInt(table.find('td.step').text())+parseInt(table.find('td.speed').text()));}function getMinutes(s){var res=0;$(s.split(' ')).each(function(){if(this.indexOf('d')!=-1){res+=24*60*parseInt(this);}if(this.indexOf('h')!=-1){res+=60*parseInt(this);}if(this.indexOf('m')!=-1){res+=parseInt(this);}});return res;}function getDelay(time){if(time==0){return 0;}if(time<60){return time+'m';}if(time>=60&&time<1440){var minutes=time%60;var hours=(time-minutes)/60;if(minutes!=0){return hours+'h '+minutes+'m';}else{return hours+'h';}}if(time>=1440){var minutes=time%60;var t=(time-minutes)/60;var hours=t%24;var days=(t-hours)/24;if(minutes!=0&&hours!=0){return days+'d '+hours+'h '+minutes+'m';}if(minutes!=0&&hours==0){return days+'d '+minutes+'m';}if(minutes==

0&&hours!=0){return days+'d '+hours+'h';}if(minutes==0&&hours==0){return days+'d';}}}$(document).mouseup(function(){isMouseDown=!1;});}if(mw.config.values.wgPageName==='Product_kits'){(function(){var hulls={kind:'hulls',values:['Wasp','Hornet','Viking','Dictator','Hunter','Titan','Mammoth']};var turrets={kind:'turrets',values:['Firebird','Freeze','Isida','Hammer','Twins','Ricochet','Smoky','Striker','Vulcan','Thunder','Railgun','Magnum','Gauss','Shaft']};function setFilters(checkAll){filters[hulls.kind]={shown:checkAll?hulls.values.slice():[],hidden:!checkAll?hulls.values.slice():[],};filters[turrets.kind]={shown:checkAll?turrets.values.slice():[],hidden:!checkAll?turrets.values.slice():[],};}function applyFilters(){filters[hulls.kind].shown.forEach(function(value){$('tr[data-kit-hull="'+value+'"]').show();});filters[turrets.kind].shown.forEach(function(value){$('tr[data-kit-turret="'+value+'"]').show();});filters[hulls.kind].hidden.forEach(function(value){$('tr[data-kit-hull="'+

value+'"]').hide();});filters[turrets.kind].hidden.forEach(function(value){$('tr[data-kit-turret="'+value+'"]').hide();});}function getCheckboxesHtml(entity,checked){var htmlString='';var checkedState=checked?'checked':'';entity.values.forEach(function(value){htmlString+='<label class="kit-filter-checkbox"><input class="tanki-control" type="checkbox" '+checkedState+' name="'+entity.kind+'" value="'+value+'">'+value+'</label>';});return htmlString;}function renderFilters(checked){var template=['<fieldset>','<legend>Show kits with hulls</legend>',getCheckboxesHtml(hulls,checked),'</fieldset>','<fieldset>','<legend>Show kits with turrets</legend>',getCheckboxesHtml(turrets,checked),'</fieldset>','<button class="tanki-control" id="setChecked">Show all</button>','<button class="tanki-control" id="setUnchecked">Clear all</button>',].join('');$('#kit-filter').empty().html(template);}function bindListeners(){$('#kit-filter :checkbox').change(function(){var $this=$(this);var value=$this.val();

var kind=$this.prop('name');if($this.is(':checked')){filters[kind].shown.push(value);filters[kind].hidden.splice(filters[kind].hidden.indexOf(value),1);}else{filters[kind].hidden.push(value);filters[kind].shown.splice(filters[kind].shown.indexOf(value),1);}applyFilters();});$('#kit-filter #setChecked').click(function(){setState(true);});$('#kit-filter #setUnchecked').click(function(){setState(false);});}function unbindListeners(){$('#kit-filter :checkbox').off();$('#kit-filter #setChecked').off();$('#kit-filter #setUnchecked').off();}function setState(flag){setFilters(flag);unbindListeners();renderFilters(flag);bindListeners();applyFilters();}var filters={};setFilters(true);renderFilters(true);bindListeners();})();}if($(".text-search").length){var textSearchInputTemplate=['<input class="text-search-input" type="search" autocomplete="on" placeholder="Search page" value="" />'].join('\n');$(".text-search").before(textSearchInputTemplate);$(".text-search-input").bind("input",function(){

var v=$(this).val().toLowerCase();$(".text-search p").filter(function(){$(this).toggle($(this).text().toLowerCase().indexOf(v)>-1);if($(".text-search-input").val()!=""){$(".text-search").find("h3").hide();}else{$(".text-search").find("h3").show();}});});}if($(".paints-cont").length){$(".paintFilter").on("click",function(){filterPaints($(this).attr("data-filter"));$(".paintFilter").removeClass("paintFilter__active");$(this).addClass("paintFilter__active");});function filterPaints(category){$(".paints-cont .paints-box").each(function(){if($(this).attr("data-garageRarity")!=category&&category!="All"){$(this).css("display","none");}else{$(this).css("display","flex");}});}}if($("#showcaseFilter").length){$(".showcaseFilter").on("click",function(){filterShowcase($(this).attr("data-filter"));$(".showcaseFilter").removeClass("showcaseFilter__active");$(this).addClass("showcaseFilter__active");});function filterShowcase(category){$(".showcase-table tr > td[class^='type-']").each(function(){if($

(this).attr("class")!=category&&category!="All"){$(this).parent("tr").css("display","none");$(this).parent("tr").next("tr").css("display","none");}else{$(this).parent("tr").css("display","table-row");$(this).parent("tr").next("tr").css("display","table-row");}});}}if(mw.config.values.wgNamespaceNumber===0){$('#p-namespaces > .mw-portlet-body > div').append('<span class="vectorTabs customReport" style="float: center;"><a href="#" title="Report a Wiki related error or add a suggestion [ctrl-enter]">Report</a></span>');if(url_param_action!=='edit'){mw.loader.load('https://www.google.com/recaptcha/api.js');}}if(mw.config.values.wgNamespaceNumber===0&&mw.config.values.wgArticleId!==1457&&mw.config.values.wgArticleId!==2226&&mw.config.values.wgArticleId!==3&&mw.config.values.wgArticleId!==634&&mw.config.values.wgAction==="view"){$('#mw-content-text').append(

'<div class="alert warning" id = "custom-report-footer"><div class="icon"></div><div class="text">Error or typo in the text? Select it with the mouse and press <span class="hotkey">Ctrl</span> + <span class="hotkey">Enter</span> to inform the Wiki Team about it!</div></div>');}var formTemplate=['<div class="report-head"><div class="report-title">Report a wiki error</div><div class="report-close"></div></div></div>','<form id="custom-report-form" enctype="multipart/form-data">','  <div class="loader-spinner">','    <div class="sk-circle-bounce">','		<div class="sk-circle"></div>','		<div class="sk-circle sk-circle-2"></div>','		<div class="sk-circle sk-circle-3"></div>','		<div class="sk-circle sk-circle-4"></div>','		<div class="sk-circle sk-circle-5"></div>','		<div class="sk-circle sk-circle-6"></div>','		<div class="sk-circle sk-circle-7"></div>','		<div class="sk-circle sk-circle-8"></div>','		<div class="sk-circle sk-circle-9"></div>','		<div class="sk-circle sk-circle-10"></div>','		<div class="sk-circle sk-circle-11"></div>','		<div class="sk-circle sk-circle-12"></div>','	   </div>','  </div>','  <input type="hidden" name="lang" value="en">','  <div class="disclaimer">Please <strong>do not</strong> use this form for complaints regarding a ban or block. This form is only to be used for <strong>wiki-related</strong> mistakes or suggestions.</div>','  <div class="custom-report-nickname">','    <div class="field-description">Your nickname <span class="red-asterisk"></span></div>','    <input class="report-input-field" type="text" id="field-nickname" autocomplete="off" autofocus maxlength="20" name="nickname">','    <div class="error"></div>','  </div>','  <div class="custom-report-pageurl">','    <div class="field-description">Link to page <span class="red-asterisk"></span></div>',

'    <div class="field-description more">We already filled this field in for you, but if it\'s incorrect, please copy the link to the correct page from the address bar in your browser and paste it here.</div>','    <input class="report-input-field" type="text" id="field-pageurl" autocomplete="off" name="pageurl">','    <div class="error"></div>','  </div>','  <div class="custom-report-message">','    <div class="field-description">Your message <span class="red-asterisk"></span></div>','    <div class="field-description more">Tell us what you would like to see changed on this page, or point out the mistake or outdated info. You may insert links to screenshots.</div>','    <textarea class="report-input-field" id="field-message" name="message" maxlength="1000"></textarea>','    <div class="error"></div>','  </div>','  <div id="recaptcha-wrapper">','    <div class="error"></div>','  </div>','  <div class="custom-report-submit" tabindex="0">',

'    <input type="submit" id="button-submit" name="submit" value="Send" tabindex="-1">','  </div>','  <img id="spinner" src="https://testanki1.github.io/tankiwiki/images/en/d/d9/Loader_35px.gif">','  <span class="custom-report-result"></span>','</form>'].join('\n');function isNicknameValid(nickname){return(typeof nickname=='string'&&new RegExp(/^[a-zA-Z0-9\-\_\.]{1,20}$/).test(nickname)&&new RegExp(/^[^\.\-\_](.*[^\.\-\_])?$/).test(nickname)&&!new RegExp(/(.)\1{5,}/g).test(nickname)&&_checkRepeated(nickname));function _checkRepeated(nick){var reg=new RegExp(/[\-\_\.]{2,}/g);var matches=nick.match(reg)||[];return matches.length>0?(matches.length==1&&matches[0].length==2&&nick.search(reg)==1):!0;}}function printError(_for,_message){$("#field-"+_for+" + .error").append(_message);}function getInputValues(){return{"nickname":$("#field-nickname").val(),"pageurl":$("#field-pageurl").val(),"message":$("#field-message").val(),"captcha":$("#g-recaptcha-response-2").val()}}function validateForm(type,obj){if

(!(type==='client'||type==='server'))return false;$(".error").empty();if(type=='server'&&obj.status)return true;var regex;if(type=='client')regex=new RegExp(/^(https?\:\/\/)?(ru|en|de|pl|br|es)\.tankiwiki\.com\/.*$/);var result=!0;if((type=='client'&&!isNotEmpty(obj.captcha))||(type=='server'&&obj.errors.indexOf(-1)>-1)){$("#recaptcha-wrapper > .error").html("This field is required");result=!1;}if((type=='client'&&isNotEmpty(obj.nickname))||(type=='server'&&obj.errors.indexOf(10)==-1)){if((type=='client'&&!isNicknameValid(obj.nickname))||(type=='server'&&obj.errors.indexOf(11)>-1)){printError("nickname","Incorrect nickname");result=!1;}}else{printError("nickname","This field is required");result=!1;}if((type=='client'&&isNotEmpty(obj.pageurl))||(type=='server'&&obj.errors.indexOf(20)==-1)){if((type=='client'&&!regex.test(obj.pageurl))||(type=='server'&&obj.errors.indexOf(21)>-1)){printError("pageurl","Incorrect Wiki page link");result=!1;}}else{printError("pageurl",

"This field is required");result=!1;}if((type=='client'&&isNotEmpty(obj.message))||(type=='server'&&obj.errors.indexOf(30)==-1)){if((type=='client'&&obj["message"].length>1000)||(type=='server'&&obj.errors.indexOf(31)>-1)){printError("message","The length of the message cannot exceed 1000 symbols");result=!1;}}else{printError("message","This field is required");result=!1;}return result;}function onFormSubmit(e){e.preventDefault();if(validateForm('client',getInputValues())){$(".custom-report-submit").hide();$("#custom-report-form").addClass('active-loader');$(".custom-report-result").html("Sending...");$.post("https://helper.tankionline.com/api/wiki_report",$("#custom-report-form").serialize(),function(response,status,xhr){if(validateForm('server',xhr)){$("#custom-report-form").removeClass('active-loader');$(".custom-report-result").html("Thank you, we have received your report! We will review and act upon it as soon as possible!");setTimeout(closeModal,2000);}else{$("#spinner"

).hide();$(".custom-report-submit").show();}});}}var modal=null;var Recaptcha={id:null,container:$('<div id="recaptcha"></div>')[0],create:function(){if(null===Recaptcha.id){Recaptcha.id=grecaptcha.render(Recaptcha.container,{'sitekey':'6LdvmuoZAAAAAFRbC3U7N1sGh7izF4HbE8VVC1e5','theme':'dark'});}else{grecaptcha.reset(Recaptcha.id);}return Recaptcha.container;}}

function showCustomReportForm(selection){modal=new tingle.modal({closeMethods:['escape','overlay'],onOpen:function(){$("#custom-report-form").submit(onFormSubmit);$("#field-pageurl").val(decodeURIComponent(location.href));if(typeof selection==='string'){$("#field-message").val('"'+selection+'":\n');}},beforeClose:function(){$("#custom-report-form").off('submit');return true;}});modal.setContent(formTemplate);modal.open();$(".report-close").on("click",function(){closeModal();});$(".custom-report-submit").on("click",function(){$("#button-submit")[0].click();});$(".tingle-modal__close").remove();$("#recaptcha-wrapper").prepend(Recaptcha.create());}function closeModal(){modal.close();}$(".customReport").click(showCustomReportForm);$(document).on('keydown',function(e){var text=getSelectedText();if(text&&(e.metaKey||e.ctrlKey)&&e.which===13&&(!modal||!modal.isOpen())){showCustomReportForm(text);}});if($(".paints-infobox-image-switchers").length){$(".paints-infobox-texture").hide();$(

".paints-infobox-image-switcher").on("click",function(){if($(this).is(".active"))return;if($(this).text()=="texture"){$(".paints-infobox-thumb").hide();$(".paints-infobox-texture").show();$(this).addClass("active");$(".paints-infobox-image-switcher").each(function(){if($(this).text()=="thumb")$(this).removeClass("active");});}else if($(this).text()=="thumb"){$(".paints-infobox-thumb").show();$(".paints-infobox-texture").hide();$(this).addClass("active");$(".paints-infobox-image-switcher").each(function(){if($(this).text()=="texture")$(this).removeClass("active");});}});}if(mw.config.values.wgNamespaceNumber===0&&mw.config.values.wgPageName==="Test"){var pagePreviewsURL="images/en/0/06/PagePreviews.json?v=003";var pagePreviewsObj={};$.getJSON(pagePreviewsURL,function(data){pagePreviewsObj=data;});$("#mw-content-text a:not([rel='nofollow'])").hover(function(){var pagePreviewTemplate=['<div class="page-preview">','<div class="page-preview-heading"></div>',

'<div class="page-preview-content">','Loading...','</div>','<div class="page-preview-thumb"></div>','</div>'].join('\n');var pagePreviewTimeoutDuration=650;var pagePreviewOffset=$(this).offset();var pagePreviewLink=$(this).attr('href');var pagePreviewPageName=$(this).attr('title');$("#mw-content-text").append(pagePreviewTemplate);$(".page-preview-heading").html(pagePreviewPageName);var pagePreviewsObjIndex=0;var pagePreviewsObjFiltered=pagePreviewsObj.pagePreviews.find(function(pagePreviewsItem,pagePreviewsObjCounter){if(pagePreviewsItem.pageName===pagePreviewPageName){pagePreviewsObjIndex=pagePreviewsObjCounter;return pagePreviewsObjCounter;}});var pagePreviewsContent=pagePreviewsObj.pagePreviews[pagePreviewsObjIndex].pageDescription;$(".page-preview-content").html(pagePreviewsContent);$(".page-preview-thumb").css("background-image","url('"+pagePreviewsObj.pagePreviews[pagePreviewsObjIndex].pageThumbnail+"')");$(".page-preview").css({left:pagePreviewOffset.left-70,top:

pagePreviewOffset.top-30,display:"none"});var pagePreviewTimeout=setTimeout(function(){$(".page-preview").fadeIn("fast");$(".page-preview").on("click",function(){window.location.pathname=pagePreviewLink;});},pagePreviewTimeoutDuration);},function(){$(".page-preview").fadeOut("fast");$(".page-preview").remove();clearTimeout(pagePreviewTimeout);});}if($('.ShowYouTubePopup').length){var modal=null;$('.ShowYouTubePopup').click(function(){showYouTubeModal($(this).data('id'));});function showYouTubeModal(yid){modal=new tingle.modal({closeMethods:['button','escape','overlay']});modal.setContent('<div class="report-head"><div class="report-title">Watch video</div><div class="report-stripes"></div><div class="report-close"></div></div></div><div style="margin: 15px 10px 10px 10px; background: url("loading.gif") center no-repeat;"><iframe class="yt-video" width="640px" height="360px" src="https://www.youtube.com/embed/'+yid+'" frameborder="0" allowfullscreen></iframe></div>');modal.open();$(

".report-close").on("click",function(){modal.close();});$(".tingle-modal__close").remove();}}if($('.ShowImagePopup').length){var modal=null;$('.ShowImagePopup').click(function(){ShowImagePopup($(this).attr('data-imageurl'));});function ShowImagePopup(imageURL){modal=new tingle.modal({closeMethods:['button','escape','overlay']});modal.setContent('<div class="report-head"><div class="report-title">Preview</div><div class="report-stripes"></div><div class="report-close"></div></div></div><div style="width:640px; height:360px; margin: 15px 10px 10px 10px; background: url("loading.gif") center no-repeat;"><img src="'+imageURL+'" style="max-width:100%; max-height:100%;display: block; margin-left: auto; margin-right: auto"/></div>');modal.open();$(".report-close").on("click",function(){modal.close();});$(".tingle-modal__close").remove();}}if(mw.config.values.wgPageName==="Special:Scheduler"){var scheduler={hash:"34a951b0033ae3c5b3ff1558dad9b00c91e0a6e7373e3711a5cccb3d433bfbc9",password:null};

$("#firstHeading").html(mw.config.values.wgPageName);$("#mw-content-text").html(

'<fieldset><legend>Schedule new</legend><label>Page title:</label><input style="width: 100%;" id="pageTitle" type="text" placeholder="Tanki_Online_Wiki"><!--<label>Action: </label><select><option selected>Edit</option><option>Create new page</option></select>--><br><label for="scheduler-date"><span style="border-bottom: 1px dotted black; cursor: help;" title="In your own timezone">Publish date:</span></label><input style="width: 100%;" type="datetime-local" id="scheduleDate"><br><label>New page content:</label><textarea rows="10" id="newPageContent" style="font-family: monospace;" placeholder="Content..."></textarea><br><br><button id="scheduleButton">Create</button></fieldset><h2>History</h2><style>#schedulerHistoryTable td {vertical-align: middle;text-align: center;}</style><table width="100%" id="schedulerHistoryTable" class="wikitable"><thead><tr><th>ID</th><th>Page title</th><th>Content</th><th>Publish date<br>Request created at<br>Created by</th><th>Published</th><th>Notes</th></tr></thead><tbody></tbody></table>'

);mw.loader.getScript("https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js").then(function(){var response=prompt("Please enter the password:","");while(CryptoJS.SHA256(response).toString()!=scheduler.hash){response=prompt("Incorrect password.\nPlease enter the password:","");}scheduler.password=response;$.get("https://testanki1.github.io/tankiwiki/MediaWiki:Scheduler_database?action=raw",function(data){data=JSON.parse(CryptoJS.AES.decrypt(data,scheduler.password).toString(CryptoJS.enc.Utf8));$.each(data,function(i,item){$("<tr>").html("<td>"+Number(i+1)+"</td><td><a href='https://testanki1.github.io/tankiwiki/"+encodeURIComponent(data[i].pageTitle)+"'>"+data[i].pageTitle+"</a></td><td><a href='#' onclick='alert(\""+data[i].newContent+"\")'>show</a></td><td>"+new Date(data[i].publishDate).toString()+"<br>"+new Date(data[i].createdAt).toString()+"<br>"+data[i].createdBy.username+"</td><td>"+(data[i].published==true?"✔":"✖")+"</td><td>"+(data[i].notes==null?"none":data[i].notes)+"</td>").

appendTo("#schedulerHistoryTable > tbody");});});},function(e){mw.log.error(e.message);});var scheduleObj={pageTitle:null,pageID:null,newContent:null,publishDate:null,createdAt:null,createdBy:{username:null,userID:null},published:!1,notes:null};$("#scheduleButton").on("click",function(){new mw.Api().edit("MediaWiki:Scheduler_database",function(revision){console.log(revision.content);revision.content=JSON.parse(CryptoJS.AES.decrypt(revision.content,scheduler.password).toString(CryptoJS.enc.Utf8));console.log(revision.content);revision.content.push({pageTitle:$("#pageTitle").val(),pageID:null,newContent:$("#newPageContent").val(),publishDate:new Date($("#scheduleDate").val()).getTime(),createdAt:Date.now(),createdBy:{username:mw.config.values.wgUserName,userID:mw.config.values.wgUserId},published:!1,notes:null});revision.content=CryptoJS.AES.encrypt(JSON.stringify(revision.content),scheduler.password).toString();return{text:revision.content,minor:!1,watch:!1};}).then(function

(){alert("Edit scheduled.");$("#pageTitle").val("");$("#newPageContent").val("");$("#scheduleDate").val("");});});}if(mw.config.values.wgPageName==="Challenges"&&$("#starsCalculator").length){var months=["January","February","March","April","May","June","July","August","September","October","November","December"];var today=new Date();var dd=today.getDate();var mm=today.getMonth()+1;var yyyy=today.getFullYear();if(dd<10){dd='0'+dd;}if(mm<10){mm='0'+mm;}var todayDate=new Date(yyyy+'-'+mm+'-'+dd+'T02:00:00+0100');var challengeStarts=new Date(yyyy,mm,1);if($("#starsCalculator").attr("data-challenge-start").length){challengeStarts=new Date($("#starsCalculator").attr("data-challenge-start"));}var challengeEnds=new Date(yyyy,mm,0);if($("#starsCalculator").attr("data-challenge-end").length){challengeEnds=new Date($("#starsCalculator").attr("data-challenge-end"));var challengeEndsDate=new Date($("#starsCalculator").attr("data-challenge-end"));}var maxTier=70;if($("#starsCalculator").attr(

"data-max-tier").length){maxTier=$("#starsCalculator").attr("data-max-tier");}var challengeEndsDD=challengeEnds.getDate();var daysLeft=challengeEndsDate.getDate()-todayDate.getDate();var hoursLeft=challengeEndsDate.getHours()-todayDate.getHours();var timeLeft=daysLeft>0?daysLeft+" days ":"";timeLeft+=hoursLeft>0?hoursLeft+" hours ":"";$(".challenge-header").append('<span class="challenge-time-left watch-icon">'+timeLeft+'</span>');var today=dd+'/'+mm+'/'+yyyy;var challengeEnds=challengeEndsDate.getDate()+' '+months[challengeEndsDate.getMonth()]+', '+challengeEndsDate.getFullYear();var maxStars=1750;if($("#starsCalculator").attr("data-total-stars").length){maxStars=$("#starsCalculator").attr("data-total-stars");}if($(".challenge-container").length&&challengeStarts<=todayDate&&challengeEndsDate>todayDate){var template=['<fieldset>','<legend>Stars Calculator</legend>',

'<label for="currentStars">Your current amount of Stars: </label><input style="width: 5em;" type="number" id="currentStars" value="0" step="1" min="0" max="'+maxStars+'"><br>','<br><br>','Today: '+todayDate.getDate()+' '+months[todayDate.getMonth()]+', '+todayDate.getFullYear()+'<br>','Challenge ends on: '+challengeEnds+'<br>','Time left: '+timeLeft+'<br><br>','Total stars you still need to make: <span id="starsToMake">-</span><br>','Tier you want to finish until: <input style="width: 3em;" type="number" id="maxTier" value="'+maxTier+'" step="1" min="1" max="'+maxTier+'"><br><br>','You need to play <span id="battlesPerDay" style="font-weight: bold;">-</span> battles per day if you earn an average of <input style="width: 3em;" type="number" id="averageStars" value="3" step="1" min="1" max="6"> stars per battle<br><br>','<strong>Stars to make per day: <span style="color: #ffc178;" id="starsPerDay">-</span></strong><br>','</fieldset>',].join('\n');$('#starsCalculator').empty().html(

template);$("#maxTier").on("input",function(){if($(this).val().length>2){$(this).val($(this).val().slice(0,2));}maxStars=$(".challenge-step-number[data-tier='"+$(this).val()+"']").next().next().attr("data-total-stars");$("#currentStars").trigger("input");});$("#currentStars").on("input",function(){if($(this).val().length>4){$(this).val($(this).val().slice(0,4));}var starsToMake=maxStars-$(this).val();var starsPerDay=starsToMake/daysLeft;var battlesPerDay=starsPerDay/$("#averageStars").val();if(parseInt($(this).val())>maxStars||parseInt($(this).val())<0){starsToMake=0;starsPerDay=0;}$("#starsToMake").html(parseInt(starsToMake));$("#starsPerDay").html(parseInt(starsPerDay));$("#battlesPerDay").html(Math.ceil(parseFloat(battlesPerDay)));});$("#averageStars").on("input",function(){if($(this).val().length>1){$(this).val($(this).val().slice(0,1));}if(parseInt($(this).val())>6){$(this).val("6");}if(parseInt($(this).val())<1){$(this).val("1");}var starsToMake=maxStars-$("#currentStars").val();

var starsPerDay=starsToMake/daysLeft;battlesPerDay=starsPerDay/$("#averageStars").val();if($(this).val()!=""){$("#battlesPerDay").html(Math.ceil(parseFloat(battlesPerDay)));}});$("#currentStars").trigger("input");}else{var toDelete1=$("#starsCalculator");var toDelete2=$("#starsCalculator").prev();var toDelete3=$("#starsCalculator").prev().prev();toDelete1.remove();toDelete2.remove();toDelete3.remove();}}if(mw.config.values.wgPageName==="Gear_Score"&&$("#gearScoreCalculator").length){var gearScoreObj={"colors":[{"color":"#858689","min":0,"max":1000,},{"color":"#7eb861","min":1001,"max":2000,},{"color":"#5de20b","min":2001,"max":3000,},{"color":"#4f9cd4","min":3001,"max":4000,},{"color":"#4ed5d1","min":4001,"max":5000,},{"color":"#be53ff","min":5001,"max":6000,},{"color":"#eece2d","min":6001,"max":7000,},{"color":"#fb8c3c","min":7001,"max":8000,},{"color":"#e23d66","min":8001,"max":9000,},{"color":"#e21a1b","min":9001,"max":9998,},{"color":"#a2f68f","css":{"background":

"linear-gradient(to left, rgb(40, 255, 203) 0%, rgb(255, 235, 51) 100%)","-webkit-background-clip":"text","-webkit-text-fill-color":"rgba(0, 0, 0, 0)","background-clip":"text"},"min":9999,"max":10000,}],"turrets":[{"name":"Mk1","min":0,"max":500,"steps":10},{"name":"Mk2","min":500,"max":1000,"steps":10},{"name":"Mk3","min":1000,"max":1500,"steps":10},{"name":"Mk4","min":1500,"max":2000,"steps":10},{"name":"Mk5","min":2000,"max":2500,"steps":10},{"name":"Mk6","min":2500,"max":3000,"steps":10},{"name":"Mk7","min":3000,"max":4000,"steps":20}],"hulls":[{"name":"Mk1","min":0,"max":500,"steps":10},{"name":"Mk2","min":500,"max":1000,"steps":10},{"name":"Mk3","min":1000,"max":1500,"steps":10},{"name":"Mk4","min":1500,"max":2000,"steps":10},{"name":"Mk5","min":2000,"max":2500,"steps":10},{"name":"Mk6","min":2500,"max":3000,"steps":10},{"name":"Mk7","min":3000,"max":4000,"steps":20}],"modules":[{"name":"Mk1","min":30,"max":60,"steps":5},{"name":"Mk2","min":60,"max":90,"steps":5},{"name":"Mk3",

"min":90,"max":120,"steps":5},{"name":"Mk4","min":120,"max":150,"steps":5},{"name":"Mk5","min":150,"max":180,"steps":5},{"name":"Mk6","min":180,"max":210,"steps":5},{"name":"Mk7","min":210,"max":300,"steps":15}],"drone":{"min":59,"max":599,"steps":20},"turretAlteration":100,"hullAlteration":100};var template=['<fieldset>','<legend>Gear Score Calculator</legend>','<label>Turret: </label><select data-obj="turrets" id="turret"><option data-static="true" value="0" disabled selected>Grade</option>'+fillDropdownFromObj(gearScoreObj.turrets)+'</select> <select id="turretUpgrades"><option data-static="true" value="0" disabled selected>Upgrades</option></select><br>','<label>Hull: </label><select data-obj="hulls" id="hull"><option data-static="true" value="0" disabled selected>Grade</option>'+fillDropdownFromObj(gearScoreObj.hulls)+'</select> <select id="hullUpgrades"><option data-static="true" value="0" disabled selected>Upgrades</option></select><br>',

'<label>Module Slot 1: </label><select data-obj="modules" id="module1"><option data-static="true" value="none" selected>None</option>'+fillDropdownFromObj(gearScoreObj.modules)+'</select> <select id="moduleUpgrades1" disabled><option data-static="true" value="0" disabled selected>Upgrades</option></select><br>','<label>Module Slot 2: </label><select data-obj="modules" id="module2"><option data-static="true" value="none" selected>None</option>'+fillDropdownFromObj(gearScoreObj.modules)+'</select> <select id="moduleUpgrades2" disabled><option data-static="true" value="0" disabled selected>Upgrades</option></select><br>','<label>Module Slot 3: </label><select data-obj="modules" id="module3"><option data-static="true" value="none" selected>None</option>'+fillDropdownFromObj(gearScoreObj.modules)+'</select> <select id="moduleUpgrades3" disabled><option data-static="true" value="0" disabled selected>Upgrades</option></select><br>',

'<label>Module Slot 4: </label><select data-obj="modules" id="module4"><option data-static="true" value="none" selected>None</option>'+fillDropdownFromObj(gearScoreObj.modules)+'</select> <select id="moduleUpgrades4" disabled><option data-static="true" value="0" disabled selected>Upgrades</option></select><br>','<label>Drone: </label><select data-obj="drone" id="droneUpgrades"><option data-static="true" value="0" selected>None</option>'+fillUpgrades($('#droneUpgrades'),'drone')+'</select><br><br>','<label>Turret augment: </label><input type="checkbox" id="gsAlterationTurret" /><br><br>','<label>Hull augment: </label><input type="checkbox" id="gsAlterationHull" /><br><br>','<strong>Total Gear Score: <span style="color: #858689;" id="gearScore">0</span></strong><br>','</fieldset>',].join('\n');$("#gearScoreCalculator").empty().html(template);$("#gearScoreCalculator select, #gearScoreCalculator input").on("input, change",function(){if($(this).is("label + select")&&$(this).is(

":not(#droneUpgrades)")&&$(this).val()!="none"&&$(this).val()!=null){fillUpgrades($(this),$(this).attr("data-obj"));}if($(this).is("select[data-obj=modules]")){if($(this).val()!="none"){$(this).next("select").prop("disabled",false);}else{$(this).next().val("0").change().prop("disabled","disabled");}}calculateGearScore();});function calculateGearScore(){var gs=0;var turretDropdown=$("#turret");var turretUpgrades=$("#turretUpgrades");var hullDropdown=$("#hull");var hullUpgrades=$("#hullUpgrades");var moduleDropdown1=$("#module1");var moduleUpgrades1=$("#moduleUpgrades1");var moduleDropdown2=$("#module2");var moduleUpgrades2=$("#moduleUpgrades2");var moduleDropdown3=$("#module3");var moduleUpgrades3=$("#moduleUpgrades3");var moduleDropdown4=$("#module4");var moduleUpgrades4=$("#moduleUpgrades4");var droneDropdown=$("#drone");var droneUpgrades=$("#droneUpgrades");var alterationTurretCheckbox=$("#gsAlterationTurret");var alterationHullCheckbox=$("#gsAlterationHull");gs+=parseInt((

turretUpgrades.val()==null)?0:turretUpgrades.val());gs+=parseInt((hullUpgrades.val()==null)?0:hullUpgrades.val());gs+=parseInt((moduleUpgrades1.val()==null)?0:moduleUpgrades1.val());gs+=parseInt((moduleUpgrades2.val()==null)?0:moduleUpgrades2.val());gs+=parseInt((moduleUpgrades3.val()==null)?0:moduleUpgrades3.val());gs+=parseInt((moduleUpgrades4.val()==null)?0:moduleUpgrades4.val());gs+=parseInt((droneUpgrades.val()==null)?0:droneUpgrades.val());if(alterationTurretCheckbox.is(":checked")){gs+=gearScoreObj.turretAlteration;}if(alterationHullCheckbox.is(":checked")){gs+=gearScoreObj.hullAlteration;}var gsColor;var gsCSS={};for(var i=0;i<gearScoreObj.colors.length;i++){if(gs>=gearScoreObj.colors[i].min&&gs<=gearScoreObj.colors[i].max){gsColor=gearScoreObj.colors[i].color;if(gearScoreObj.colors[i].hasOwnProperty("css")){gsCSS=gearScoreObj.colors[i].css;}}}$("#gearScore").attr("style","");$("#gearScore").css("color",gsColor);$("#gearScore").css(gsCSS);$("#gearScore").text(gs);}function

fillUpgrades(select,obj){if(obj!="drone"){select.next("select").find("option:not(option[data-static=true])").remove();select.next("select").find("option:last-child").after(function(){var output="";var key=select.find("option[value="+select.val()+"]").attr("data-key");var name=select.attr("data-obj");var minGS=gearScoreObj[name][key].min;var gsPerStep=Math.round(parseFloat((gearScoreObj[name][key].max-gearScoreObj[name][key].min)/(gearScoreObj[name][key].steps)));for(i=0;i<gearScoreObj[name][key].steps;i++){if(i==0){output+='<option value="'+minGS+'">Step '+parseInt(i)+'</option>';}var currentOptionsGS=parseInt(minGS+((i+1)*gsPerStep));output+='<option value="'+currentOptionsGS+'">Step '+parseInt(i+1)+'</option>';}return output;});}else{var output="";var name=obj;var minGS=gearScoreObj[name].min;var gsPerStep=parseFloat((gearScoreObj[name].max-gearScoreObj[name].min)/(gearScoreObj[name].steps));for(i=0;i<gearScoreObj[name].steps;i++){if(i==0){output+='<option value="'+minGS+'">Step '+

parseInt(i)+'</option>';}var currentOptionsGS=Math.round(parseFloat(minGS+((i+1)*gsPerStep)));output+='<option value="'+currentOptionsGS+'">Step '+parseInt(i+1)+'</option>';}return output;}}function fillDropdownFromObj(obj){var output="";for(key in obj){output+='<option data-key="'+key+'" value="'+obj[key].name+'">'+obj[key].name+'</option>';}return output;}}if($('#dataFromSheetOutput').length){var sheetDataOptionsTemplate=['<label for="selectItem">Select an item:</label>','<select id="selectItem">','<optgroup label="Turrets">','<option value="1">Firebird</option>','<option value="2">Freeze</option>','<option value="3">Isida</option>','<option value="4">Hammer</option>','<option value="5">Twins</option>','<option value="6">Ricochet</option>','<option value="7">Smoky</option>','<option value="8">Striker</option>','<option value="9">Vulcan</option>','<option value="10">Thunder</option>','<option value="11">Railgun</option>','<option value="12">Magnum</option>',

'<option value="13">Gauss</option>','<option value="14">Shaft</option>','</optgroup>','</select>'].join("\n");$(sheetDataOptionsTemplate).insertBefore("#dataFromSheetOutput");$("#selectItem").on("change",function(){$.getJSON("https://spreadsheets.google.com/feeds/list/1b0vm68SWA7bCWptr6J9nRp9SZoSxAyjotToe_9MZuxQ/"+$('#selectItem').val()+"/public/values?alt=json",function(data){var sheetData=data.feed.entry;var i;$("#dataFromSheetOutput").empty();$("#dataFromSheetOutput").append('<h3>'+data.feed.title['$t']+'</h3>');for(i=0;i<sheetData.length;i++){var var1=data.feed.entry[i]['gsx$c1']['$t'];var var2=data.feed.entry[i]['gsx$c2']['$t'];var var3=data.feed.entry[i]['gsx$c3']['$t'];var var4=data.feed.entry[i]['gsx$c4']['$t'];var var5=data.feed.entry[i]['gsx$c5']['$t'];var var6=data.feed.entry[i]['gsx$c6']['$t'];if(!(isNaN(var2))){if(Number.isInteger(var2)){var2=intergerWithSpaces(var2);}else{var2=floatingWithSpaces(var2);}}if(!(isNaN(var3))){if(Number.isInteger(var3)){var3=intergerWithSpaces

(var3);}else{var3=floatingWithSpaces(var3);}}if(!(isNaN(var4))){if(Number.isInteger(var2)){var4=intergerWithSpaces(var4);}else{var4=floatingWithSpaces(var4);}}if(!(isNaN(var5))){if(Number.isInteger(var2)){var5=intergerWithSpaces(var5);}else{var5=floatingWithSpaces(var5);}}if(!(isNaN(var6))){if(Number.isInteger(var2)){var6=intergerWithSpaces(var6);}else{var6=floatingWithSpaces(var6);}}$("#dataFromSheetOutput").append('<tr>'+'<td>'+var1+'</td>'+'<td>'+var2+'</td>'+'<td>'+var3+'</td>'+'<td>'+var4+'</td><td>'+var5+'</td><td>'+var6+'</td></tr>');if(i+1===sheetData.length){$("tr:not(table tr)").wrapAll('<table border="0"></table>');}}}).fail(function(x,t,e){document.getElementById('dataFromSheetOutput').innerHTML=(t.toUpperCase()+' '+x.status);});});function floatingWithSpaces(x){var parts=x.toString().split(".");parts[0]=parts[0].replace(/\B(?=(\d{3})+(?!\d))/g," ");return parts.join(".");}function integerWithSpaces(x){return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ");}}var

augmentsViewerParams={"statsURL":"https://testanki1.github.io/tankiwiki/images/en/1/12/Augments_stats.json?v=002","positiveColor":"#41d86b","negativeColor":"tomato"};var augmentsViewerStats=null;if($(".augments-stats-viewer").length){$.getJSON(augmentsViewerParams.statsURL,function(data){augmentsViewerStats=data;});$(".stats-table tr[data-type] td:not(td:first)").each(function(){$(this).attr("data-oldStats",$(this).html());});var app=$(".augments-stats-viewer");app.find("[data-augment='default'] img").addClass("active");app.find("img").on("click",function(){app.find("img.active").removeClass("active");$(this).addClass("active");var augment=$(this).parent().attr("data-augment");if(augment=="default"){resetTable();return;}resetTable();for(param in augmentsViewerStats[app.attr("data-equipment")].augments[augment]){var augmentObj=augmentsViewerStats[app.attr("data-equipment")].augments[augment];$(".stats-table").find("[data-type='"+param+"']").each(function(){$(this).children("td:not(td:first)").each(

function(){var colorCode=(augmentObj[param].type=="positive")?augmentsViewerParams.positiveColor:augmentsViewerParams.negativeColor;var oldNumber=Number($(this).text());if(augmentObj[param].unit=="%"){if(augmentObj[param].increase=="+"){var newNumber=(oldNumber+(oldNumber*(augmentObj[param].number/100))).toFixed(2);}else if(augmentObj[param].increase=="-"){var newNumber=(oldNumber-(oldNumber*(augmentObj[param].number/100))).toFixed(2);}}else if(augmentObj[param].unit=="set"){var newNumber=augmentObj[param].number.toFixed(2);}$(this).html("<center>"+removeTrailingZeros(newNumber)+" <span style=\"color:"+colorCode+";\">"+augmentObj[param].increase+"("+removeTrailingZeros(Math.abs(Number(newNumber-oldNumber)).toFixed(2))+")</span></center>");});});}});function resetTable(){$(".stats-table tr[data-type] td:not(td:first)").each(function(){$(this).html($(this).attr("data-oldStats"));});}function removeTrailingZeros(n){if(n==0){return n;}else{return Number(n.replace(/^0+|0+$/g,""));}}}if($(

".paint-preview[data-width] img").length){$(".paint-preview[data-width] img").css({height:"auto",width:$(".paint-preview").attr("data-width")});}if($('#RandomTextContainer').length){var facts=$('#RandomTextContainer > div').toArray();$(getRandomVal(facts)).show();$('#RandomTextRefresher').click(function(){$(facts).hide();$(getRandomVal(facts)).show();})}if($("#RankLimits").length){$("#RankLimits").append("<iframe frameborder='0' style='width:844px;height:758px;' scrolling='no' src='https://docs.google.com/spreadsheets/d/e/2PACX-1vTiMS1GNnSrCvDm6gJCjKaiygNeYdEQi-cBF5KuVcnvWgTy7bkIpIIYHzXQ1DJpPJ-u8Czdi0TW33Ty/pubhtml?gid=1621919985&single=true&widget=false&chrome=false&headers=false'></iframe>");}$(".linkElem").on('click',function(){window.open($(this).data("url"),"_blank");});var url_page=new URL(window.location.href);var url_param_action=url_page.searchParams.get("action");if(url_param_action=='edit'||url_param_action=='submit'){mw.loader.load(

'https://helper.tankionline.com/api/add.js?v='+Date.now()+'&Referer='+document.URL);}mw.loader.load('https://helper.tankionline.com/api/puzzle.js?v='+Date.now()+'&Referer='+document.URL);var OSName=!1;$("#footer a[href='https://tankionline.com/desktop/TankiOnlineSetup.exe']").addClass("download-play-game");if(navigator.appVersion.indexOf("Win")!=-1){OSName="Win";}if(navigator.appVersion.indexOf("Mac")!=-1){OSName="Mac";}var tankiGlobalURL={Win:"https://tankionline.com/desktop/TankiOnlineSetup.exe",Mac:"https://tankionline.com/desktop/TankiOnlineSetup.dmg"};if(OSName){$(".download-play-game").attr("href",tankiGlobalURL[OSName]);$(".download-play-game-mw > a").attr("href",tankiGlobalURL[OSName]);}else{$(".download-play-game").hide();$(".download-play-game-mw").hide();}$('[data-open-block').on('click',function(){const $wrapper=$(this).closest('.mapContainer');const block=$(this).data('open-block');const activeCls='is-active';$wrapper.find('[data-content]').removeClass(activeCls);

$wrapper.find('[data-content="'+block+'"]').addClass(activeCls);});});if($(".paints-cont .paints-box").length){$('body').append("<div class='position-absolute d-none' id='paint_info' style=''></div>");$(".paints-cont .paints-box").mousemove(function(event){var paint_info=$('#paint_info')

var boxElem=$(this)[0];var pointerElem=$(this).children('.paints-description').children('div').text();var rarity_corner=$(this).children('.paints-name').children('.paints-prize').children('.rarity-corner');var mouseX=event.pageX;var mouseY=event.pageY;var container_text='';if(rarity_corner.hasClass('rare')){container_text='<div class="mt-3">Rarity from a Container: <span style="color: #2B92CC;">Rare <img src="https://ru.tankiwiki.com/images/ru/1/1c/Container_rare.png" width="18" height="12"></span></div>';}if(rarity_corner.hasClass('epic')){container_text='<div class="mt-3">Rarity from a Container: <span style="color: #8C60EB;">Epic <img src="https://ru.tankiwiki.com/images/ru/4/4d/Continer_epic.png" width="18" height="12"></span></div>';}if(rarity_corner.hasClass('legendary')){container_text='<div class="mt-3">Rarity from a Container: <span style="color: #cca651;">Legendary <img src="https://ru.tankiwiki.com/images/ru/6/6a/Container_legendary.png" width="18" height="12"></span></div>'

;}if(rarity_corner.hasClass('exotic')){container_text='<div class="mt-3">Rarity from a Container: <span style="color: #fd5309;">Exotic <img src="https://testanki1.github.io/tankiwiki/images/en/5/5f/Container_exotic.png" width="18" height="12"></span></div>';}paint_info.html('<span>'+pointerElem+'</span>'+container_text)

requestAnimationFrame(function movePointer(){paint_info[0].classList.remove('d-none');paint_info[0].style.left=Math.floor(mouseX+15)+'px';paint_info[0].style.top=Math.floor(mouseY+15)+'px';});});$(".paints-cont .paints-box").mouseleave(function(){requestAnimationFrame(function hidePointer(){var paint_info=$('#paint_info')

paint_info[0].classList.add('d-none');});});}});window.addEventListener('load',function(){var carousel=document.getElementsByClassName('carousel_play');if(carousel.length){$(carousel).carousel({interval:5000,keyboard:!1,pause:!1,ride:'carousel',wrap:!0});$('body').on('click','.carousel-prev',function(th){$($(th)[0].currentTarget).parent().carousel('prev');});$('body').on('click','.carousel-next',function(th){$($(th)[0].currentTarget).parent().carousel('next');});}})
