<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D坦克字母表解谜</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=M+PLUS+1p&display=swap');
        
        * {
            -webkit-tap-highlight-color: transparent;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background-color: #001926;
            color: white;
            font-family: 'Rubik', 'M PLUS 1p';
            display: flex;
            flex-direction: column;
            align-items: center;
            height: 100vh;
            padding: 20px;
            text-align: center;
        }

        h1 {
            font-size: 2rem;
            margin-bottom: 20px;
        }

        /* Tab Styles */
        .tabs {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            width: 100%;
        }

        .tab {
            padding: 10px 20px;
            margin: 0 10px;
            cursor: pointer;
            font-size: 1.2rem;
            background-color: #00303b;
            color: white;
            border: 2px solid #00303b;
            border-radius: 8px;
        }

        .tab:hover {
            background-color: #64e629;
        }

        .tab.active {
            background-color: #76FF33;
            color: #001926;
            border-color: #76FF33;
        }

        /* Section Styles */
        .section {
            display: none;
            width: 100%;
            max-width: 600px;
            margin-top: 20px;
        }

        .section.active {
            display: block;
        }

        label {
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        input, button {
            padding: 12px;
            margin: 10px 0;
            font-size: 1rem;
            border-radius: 8px;
            border: 2px solid #76FF33;
            background-color: #002b36;
            color: white;
            transition: all 0.3s ease;
        }

        input {
            width: 100%;
            max-width: 320px;
        }

        input:focus {
            border-color: #64e629;
            outline: none;
            box-shadow: 0 0 8px rgba(103, 255, 51, 0.5);
        }

        button {
            background-color: #76FF33;
            color: #001926;
            cursor: pointer;
            font-weight: bold;
        }

        button:hover {
            background-color: #64e629;
        }

        .result {
            color: #76FF33;
            font-weight: bold;
            font-size: 1.5rem;
            margin-top: 20px;
        }

        .error {
            color: red;
            font-size: 1.2rem;
            margin-top: 20px;
        }

        .results-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .result p {
            margin: 10px 0;
        }

        .reproduce-section {
            background-color: #002b36;
            color: #76FF33;
            padding: 20px;
            border-radius: 8px;
            font-size: 1.2rem;
            text-align: left;
        }

        #lettersList button {
            margin: 5px;
            padding: 10px;
            background-color: #00303b;
            color: white;
            border: 2px solid #00303b;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1rem;
        }

        #lettersList button:hover {
            background-color: #64e629;
        }

        #lettersList button:disabled {
            background-color: #444;
            cursor: not-allowed;
        }

        #wordDisplay {
            font-size: 1.5rem;
            letter-spacing: 10px;
            margin-top: 20px;
            font-weight: bold;
        }

        #attempts {
            font-size: 1.2rem;
            font-weight: bold;
        }

        #lettersList {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 10px;
            justify-items: center;
        }

    </style>
</head>
<body>

    <h1>3D坦克字母表</h1>

    <!-- Tabs -->
    <div class="tabs">
        <div class="tab active" id="puzzleTab" onclick="switchTab('puzzle')">单词解谜</div>
        <div class="tab" id="reproduceTab" onclick="switchTab('reproduce')">游戏再现</div>
    </div>

    <!-- Sections -->
    <div class="section active" id="puzzleSection">
        <label for="length">请输入单词的长度：</label>
        <input type="number" id="length" placeholder="单词长度" min="1">
        </br>
        <label for="letters">请输入该单词中可能含有的字母：</label>
        <input type="text" id="letters" placeholder="字母输入" maxlength="16"> 
        </br>
        <button onclick="solvePuzzle()">解谜！</button>
        
        <div id="result" class="results-container"></div>
    </div>

    <div class="section" id="reproduceSection">
        <div class="reproduce-section">
            <h3>游戏再现</h3>
            <p>选择字母并猜出单词！</p>
            <div id="letterContainer">
                <p>字母选择：</p>
                <div id="lettersList"></div>
            </div>
            <div id="wordDisplay"></div>
            <p id="guessResult"></p>
            <p>选择次数：<span id="attempts">0</span></p>
            <button onclick="startGame()">开始新游戏</button>
        </div>
    </div>

    <script>
        let targetWord = '';  // 存储随机抽取的单词
        let wordLength = 0;   // 单词长度
        let guessedLetters = [];  // 用户选择的字母
        let attempts = 0;  // 选择次数
        const lettersListDiv = document.getElementById('lettersList');
        const wordDisplayDiv = document.getElementById('wordDisplay');
        const attemptsSpan = document.getElementById('attempts');
        const guessResult = document.getElementById('guessResult');

        async function fetchWords() {
            const response = await fetch('https://testanki1.github.io/alphabet/words.txt');
            const text = await response.text();
            return text.split('\n').map(word => word.trim()).filter(word => word.length > 0);
        }

        // 随机选择一个单词
        function chooseRandomWord(words) {
            const randomWord = words[Math.floor(Math.random() * words.length)].toUpperCase();
            targetWord = randomWord;
            wordLength = randomWord.length;
            guessedLetters = new Array(wordLength).fill('_'); // 填充空格
            updateWordDisplay();
        }

        // 更新单词显示
        function updateWordDisplay() {
            wordDisplayDiv.innerHTML = guessedLetters.join(' ');
        }

        // 开始新游戏
        function startGame() {
            fetchWords().then(words => {
                chooseRandomWord(words);
                attempts = 0;
                attemptsSpan.textContent = attempts;
                guessResult.textContent = '';
                setupLetterButtons();
            });
        }

        // 设置字母选择按钮
        function setupLetterButtons() {
            const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
            const targetLetters = Array.from(new Set(targetWord.split(''))); // 获取目标单词中的所有不重复字母
            const remainingLetters = letters.split('').filter(letter => !targetLetters.includes(letter));
            const allLetters = [...targetLetters, ...remainingLetters.slice(0, 16 - targetLetters.length)];

            // 按字母表顺序排列字母
            allLetters.sort();  // 排序字母

            lettersListDiv.innerHTML = ''; // 清空旧的按钮
            allLetters.forEach(letter => {
                const button = document.createElement('button');
                button.textContent = letter;
                button.onclick = () => handleLetterClick(button, letter);
                lettersListDiv.appendChild(button);
            });
        }

        // 处理字母点击
        function handleLetterClick(button, letter) {
            if (button.disabled) return; // 如果字母按钮已被禁用，返回

            let correctGuess = false;
            for (let i = 0; i < targetWord.length; i++) {
                if (targetWord[i] === letter) {
                    guessedLetters[i] = letter; // 填入字母
                    correctGuess = true;
                }
            }

            updateWordDisplay();
            attempts++;
            attemptsSpan.textContent = attempts;

            if (correctGuess) {
                guessResult.textContent = '正确！';
                button.style.backgroundColor = '#76FF33';  // 正确选择的颜色
            } else {
                guessResult.textContent = '错误！';
                button.style.backgroundColor = '#FF6666';  // 错误选择的颜色
            }

            button.disabled = true;  // 禁用已选择的字母按钮

            if (!guessedLetters.includes('_')) {
                guessResult.textContent = '恭喜你，猜对了！';
            }
        }

        function switchTab(tab) {
            const puzzleTab = document.getElementById('puzzleTab');
            const reproduceTab = document.getElementById('reproduceTab');
            const puzzleSection = document.getElementById('puzzleSection');
            const reproduceSection = document.getElementById('reproduceSection');

            // Reset tab active state
            puzzleTab.classList.remove('active');
            reproduceTab.classList.remove('active');
            puzzleSection.classList.remove('active');
            reproduceSection.classList.remove('active');

            // Activate selected tab and section
            if (tab === 'puzzle') {
                puzzleTab.classList.add('active');
                puzzleSection.classList.add('active');
            } else {
                reproduceTab.classList.add('active');
                reproduceSection.classList.add('active');
                startGame(); // 开始新游戏
            }
        }
    </script>

</body>
</html>
