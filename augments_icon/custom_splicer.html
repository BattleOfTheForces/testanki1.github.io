<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>
	3D坦克装备改造图标自定义拼接器
</title>
<style>
    body {
        background-color: #001926;
        color: white;
        font-family: Arial, sans-serif;
        text-align: center;
        margin: 0;
        padding: 0;
    }
    #svgContainer {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 50px;
    }
    #svgPreview {
        width: 256px;
        height: 256px;
        margin-bottom: 20px;
    }
    button {
    background-color: #76FF33;
    color: #001926;
    border: none;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s;
    margin-bottom: 20px;
    border-radius: 50px; /* 将按钮的 border-radius 属性设置为 50px，使其侧边看起来更接近圆形 */
}
button:hover {
    background-color: #4CAF50;
}
#downloadBtn {
    background-color: #76FF33;
    color: black;
    border: none;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    transition: background-color 0.3s;
    text-decoration: none;
    border-radius: 50px; /* 将按钮的 border-radius 属性设置为 50px，使其侧边看起来更接近圆形 */
}
#downloadBtn:hover {
    background-color: #4CAF50;
}
    a {
        color: inherit;
        text-decoration: none;
    }
</style>
<script>
    document.addEventListener('DOMContentLoaded', function () {
    document.getElementById('svgName').addEventListener('change', toggleGenerateBtn);
    document.getElementById('txtName').addEventListener('change', toggleGenerateBtn);
document.getElementById('quality').addEventListener('change', generateSVG);
});
function toggleGenerateBtn() {
    var txtName = document.getElementById('txtName').value.trim();
    var svgName = document.getElementById('svgName').value.trim();
    // 检查装备和改造是否都选择了
    if (txtName !== '' && svgName !== '') {
        generateSVG(); // 自动调用生成图标函数
    }
}
function generateSVG() {
    var txtName = document.getElementById("txtName").value.trim();
    var svgName = document.getElementById("svgName").value.trim();
    var quality = document.getElementById("quality").value;
    var txtUrl = 'https://testanki1.github.io/augments_icon/equipments/' + encodeURIComponent(txtName) + '.txt';
    var svgUrl = 'https://testanki1.github.io/augments_icon/augments/' + encodeURIComponent(svgName) + '.svg';
    // 显示加载提示
    document.getElementById("loading").style.display = "block";
    fetch(txtUrl)
        .then(response => response.text())
        .then(txtContent => {
            fetch(svgUrl)
                .then(response => response.text())
                .then(svgContent => {
                    var defsIndex = svgContent.indexOf('<defs>');
                    if (defsIndex !== -1) {
                        var finalSVG = svgContent.slice(0, defsIndex) + txtContent + svgContent.slice(defsIndex);
                        // Replace fill color if quality is selected
                        if (quality !== 'default') {
                            finalSVG = finalSVG.replace(/fill="#[A-Za-z0-9]+"/, 'fill="' + quality + '"');
                        }
                        var svgPreview = document.getElementById("svgPreview");
                        svgPreview.innerHTML = finalSVG;
                        // 设置 SVG 尺寸为 256x256
                        svgPreview.querySelector("svg").setAttribute("width", "256");
                        svgPreview.querySelector("svg").removeAttribute("height"); // 移除另一个尺寸属性
                        var blob = new Blob([finalSVG], { type: 'image/svg+xml' });
                        var url = URL.createObjectURL(blob);
                        var a = document.createElement('a');
                        a.href = url;
                        a.download = txtName + '的' + svgName + '.svg'; // 设置下载的文件名
                        a.textContent = '保存 SVG 矢量图'; // Change to "下载图标"
                        // 替换下载按钮
                        var downloadBtn = document.getElementById("downloadBtn");
                        downloadBtn.innerHTML = "";
                        downloadBtn.appendChild(a);
                        // 隐藏加载提示
                        document.getElementById("loading").style.display = "none";
                    } else {
                        console.error('Error: <defs> tag not found in SVG file.');
                        // 隐藏加载提示
                        document.getElementById("loading").style.display = "none";
                    }
                })
                .catch(error => {
                    console.error('Error fetching SVG file:', error);
                    // 隐藏加载提示
                    document.getElementById("loading").style.display = "none";
                });
        })
        .catch(error => {
            console.error('Error fetching TXT file:', error);
            // 隐藏加载提示
            document.getElementById("loading").style.display = "none";
        });
}
function convertToPNG() {
    var txtName = document.getElementById("txtName").value.trim();
    var svgName = document.getElementById("svgName").value.trim();
    var svg = document.getElementById("svgPreview").querySelector("svg");
    var canvas = document.createElement("canvas");
    var context = canvas.getContext("2d");
    var aspectRatio = svg.width.baseVal.value / svg.height.baseVal.value;
    var width = parseInt(document.getElementById("pngWidth").value) || 1024;
    var height = parseInt(document.getElementById("pngHeight").value) || 1024;
    if (width / height > aspectRatio) {
        width = height * aspectRatio;
    } else {
        height = width / aspectRatio;
    }
    canvas.width = width;
    canvas.height = height;
    var svgString = new XMLSerializer().serializeToString(svg);
    var img = new Image();
    img.onload = function () {
        context.drawImage(img, 0, 0, width, height);
        var link = document.createElement('a');
        link.download = txtName + '的' + svgName + '.png'; // 设置下载的文件名
        link.href = canvas.toDataURL('image/png');
        link.click();
    };
    img.src = 'data:image/svg+xml;base64,' + btoa(svgString);
}
</script>
<h1>
	3D坦克装备改造图标自定义拼接器
</h1>
<div id="svgContainer">
	<label for="txtName">选择装备：</label> <select id="txtName"> <option value="">请选择装备</option><option value="无">无</option><option value="泰坦">泰坦</option>
		<option value="圣骑士">圣骑士</option>
        <option value="猛犸象">猛犸象</option>
        <option value="猎人中甲">猎人中甲</option>
        <option value="蜂王">蜂王</option>
        <option value="霍珀">霍珀</option>
        <option value="独裁者">独裁者</option>
        <option value="阿瑞斯">阿瑞斯</option>
        <option value="十字军">十字军</option>
        <option value="维京">维京</option>
        <option value="黄蜂轻甲">黄蜂轻甲</option>
<option value="滑膛炮">滑膛炮</option>
<option value="冰风暴">冰风暴</option>
<option value="火焰炮">火焰炮</option>
<option value="蝎子">蝎子</option>
<option value="镭射炮">镭射炮</option>
<option value="火龙珠">火龙珠</option>
<option value="激光炮">激光炮</option>
<option value="磁力炮">磁力炮</option>
<option value="雷暴炮">雷暴炮</option>
<option value="火箭炮">火箭炮</option>
<option value="轰天炮">轰天炮</option>
<option value="极速炮">极速炮</option>
<option value="离子炮">离子炮</option>
<option value="马格南">马格南</option>
<option value="电磁炮">电磁炮</option>
<option value="特斯拉">特斯拉</option>
    </select><br />
<label for="svgName">选择改造：</label> <select id="svgName"> <option value="">请选择改造</option>
<option value="极端轻型结构">极端轻型结构</option>
	<option value="爆破手">爆破手</option>
        <option value="工兵">工兵</option>
        <option value="驱动器">驱动器</option>
        <option value="轻型结构">轻型结构</option>
        <option value="重型结构">重型结构</option>
        <option value="耐寒性">耐寒性</option>
        <option value="耐热性">耐热性</option>
        <option value="抗干扰器">抗干扰器</option>
        <option value="攻强免疫">攻强免疫</option>
        <option value="抗电磁脉冲">抗电磁脉冲</option>
        <option value="抗眩晕">抗眩晕</option>
        <option value="抗热">抗热</option>
        <option value="抗寒">抗寒</option>
        <option value="救生员">救生员</option>
        <option value="工程师">工程师</option>
<option value="肾上腺素">肾上腺素</option>
<option value="凤凰">凤凰</option>
<option value="拖延协议">拖延协议</option>
<option value="加速协议">加速协议</option>
<option value="负能量场">负能量场</option>
<option value="震动冻结">震动冻结</option>
<option value="入侵瞄准处理器">入侵瞄准处理器</option>
<option value="射击速度调节器">射击速度调节器</option>
<option value="干扰弹">干扰弹</option>
<option value="更快速的水平跟踪">更快速的水平跟踪</option>
<option value="橡胶炮弹">橡胶炮弹</option>
<option value="轻型电容器">轻型电容器</option>
<option value="重型电容器">重型电容器</option>
<option value="治疗发射器">治疗发射器</option>
<option value="纳米反应器">纳米反应器</option>
<option value="支援纳米机器人">支援纳米机器人</option>
<option value="宽带纳米发射器">宽带纳米发射器</option>
<option value="吸血鬼纳米机器人">吸血鬼纳米机器人</option>
<option value="精确瞄准系统">精确瞄准系统</option>
<option value="超累积炮弹">超累积炮弹</option>
<option value="突击弹药">突击弹药</option>
<option value="穿甲弹">穿甲弹</option>
<option value="燃烧弹">燃烧弹</option>
<option value="分类弹药">分类弹药</option>
<option value="自动加农炮">自动加农炮</option>
<option value="高容量弹鼓">高容量弹鼓</option>
<option value="电子偶">电子偶</option>
<option value="重炮手">重炮手</option>
<option value="大口径短炮">大口径短炮</option>
<option value="自适应重载">自适应重载</option>
<option value="导弹发射器“旋风”">导弹发射器“旋风”</option>
<option value="远程火箭炸药">远程火箭炸药</option>
<option value="鱼叉导弹">鱼叉导弹</option>
<option value="加强炮架">加强炮架</option>
<option value="自动火药装载机">自动火药装载机</option>
<option value="电磁脉冲炮弹">电磁脉冲炮弹</option>
<option value="迫击炮">迫击炮</option>
<option value="导弹发射器“镭射”">导弹发射器“镭射”</option>
<option value="负场稳定">负场稳定</option>
<option value="等离子焰炬">等离子焰炬</option>
<option value="狂暴">狂暴</option>
<option value="赫利俄斯">赫利俄斯</option>
<option value="精确弹药装载">精确弹药装载</option>
<option value="等离子体加速器">等离子体加速器</option>
<option value="重型等离子炮">重型等离子炮</option>
<option value="稳定等离子体">稳定等离子体</option>
<option value="等离子涡轮加速器">等离子涡轮加速器</option>
<option value="腐蚀混合物">腐蚀混合物</option>
<option value="等离子发生器">等离子发生器</option>
<option value="紧凑型坦克">紧凑型坦克</option>
<option value="高压泵">高压泵</option>
<option value="脉冲星">脉冲星</option>
<option value="电磁加速器“侦察机”">电磁加速器“侦察机”</option>
<option value="超空间炮弹">超空间炮弹</option>
<option value="“死亡使者” 强制器">“死亡使者” 强制器</option>
<option value="爆炸弹头">爆炸弹头</option>
<option value="爆炸弹">爆炸弹</option>
<option value="眩晕弹">眩晕弹</option>
<option value="冷冻炮弹">冷冻炮弹</option>
    </select><br />
<label for="quality">设置稀有度：</label> <select id="quality"> <option value="default">默认</option>
        <option value=>无</option>
	<option value="#BFD5FF">普通</option>
        <option value="#76FF33">稀有</option>
        <option value="#00D4FF">珍奇</option>
        <option value="#D580FF">史诗</option>
        <option value="#FFEE00">传奇</option>
        <option value="#FF6666">异国情调</option>
    </select><br />
	<div id="svgPreview">
		<!-- Generated SVG will be displayed here -->
	</div>
	<div id="loading" style="display:none;">
		加载中……
	</div>
	<div id="downloadBtn">
		<!-- Download button will be displayed here -->
	</div>
	<div>
		转换为 PNG 图片：<br />
宽度：<input type="number" id="pngWidth" placeholder="1024" /><br />
高度：<input type="number" id="pngHeight" placeholder="1024" /><br />
<button onclick="convertToPNG()">保存为 PNG 图片</button> 
	</div>
</div>
<p style="color:white;margin-top:50px;">
	注：生成的图标仅供参考
</p>
