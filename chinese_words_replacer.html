<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3D坦克国服屏蔽词替换器</title> <!-- Title also converted for consistency -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rubik:wght@300;400;500;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=M+PLUS+1p&display=swap');
        body {
            background-color: #001926; /* 网页背景颜色 */
            color: #cccccc; /* 默认文字颜色，浅灰色以便在深色背景上阅读 */
            font-family: 'Rubik', 'M PLUS 1p';
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh; /* 使内容垂直居中 */
            box-sizing: border-box;
        }

        .container {
            background-color: #002a3f; /* 容器的背景色，比body稍亮一点 */
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
            width: 90%;
            max-width: 600px; /* 限制最大宽度 */
            box-sizing: border-box;
        }

        h1 {
            color: #ffffff;
            text-align: center;
            margin-bottom: 25px;
            /* Apply conversion to H1 text */
            font-feature-settings: "fwid"; /* Attempt CSS-based full-width, might not work universally for numbers/letters */
            /* Manual conversion might be needed if CSS doesn't work */
        }
        /* Manually convert H1 title text */
        h1::before {
             content: "3D坦克国服屏蔽词替换器"; /* Content replaced by JS below */
        }
        h1 > span { display: none; } /* Hide original H1 text if using ::before */


        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #aaddff; /* 标签颜色 */
        }

        textarea {
            width: 100%;
            min-height: 120px; /* 最小高度 */
            padding: 10px;
            margin-bottom: 20px;
            border: 1px solid #004466; /* 边框颜色 */
            border-radius: 4px;
            background-color: #001f33; /* 文本区域背景色 */
            color: #e0e0e0; /* 文本区域文字颜色 */
            font-size: 1em;
            box-sizing: border-box; /* 防止padding撑开宽度 */
            resize: vertical; /* 允许用户垂直调整大小 */
        }

        textarea:focus {
            outline: none;
            border-color: #76FF33; /* 聚焦时边框变亮绿色 */
            box-shadow: 0 0 5px rgba(118, 255, 51, 0.5);
        }

        #outputText {
            background-color: #001520; /* 输出区域背景色稍暗 */
            cursor: default; /* 表明不可编辑 */
        }

        button {
            background-color: #76FF33; /* 按钮颜色 */
            color: #001926; /* 按钮文字颜色，深色 */
            border: none;
            padding: 12px 25px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
            font-weight: bold;
            transition: background-color 0.2s ease, transform 0.1s ease;
            display: block; /* 使按钮独占一行 */
            width: 100%; /* 按钮宽度充满容器 */
            box-sizing: border-box;
        }

        button:hover {
            background-color: #68ef25; /* 鼠标悬停时颜色变深一点 */
        }

        button:active {
             transform: scale(0.98); /* 点击时轻微缩小 */
        }

    </style>
</head>
<body>
    <div class="container">
        <!-- H1 content will be set by JS -->
        <h1><span>3D坦克国服屏蔽词替换器</span></h1>

        <label for="inputText">输入文本:</label>
        <textarea id="inputText" placeholder="在这里输入需要处理的文字... 例如: abc 123 飞"></textarea>

        <label for="outputText">替换结果:</label>
        <textarea id="outputText" readonly placeholder="替换后的文字将显示在这里..."></textarea>

        <button id="copyButton">复制结果</button>
    </div>

    <script>
        // --- 屏蔽词字典 ---
        // 格式: "屏蔽词": "替换词"
        // 注意：屏蔽词现在也可能包含全角字符，如果它们是由半角转换来的
        const censorDictionary = {
            "飞": "非",
            "服": "浮",
            "测试词": "替换成功"
        };
        // --------------------

        const inputText = document.getElementById('inputText');
        const outputText = document.getElementById('outputText');
        const copyButton = document.getElementById('copyButton');
        const h1Element = document.querySelector('h1 span'); // Get the span inside h1

        // Function to convert half-width ASCII numbers and letters to full-width
        function toFullWidth(str) {
            let result = '';
            for (let i = 0; i < str.length; i++) {
                const charCode = str.charCodeAt(i);

                // Check for half-width numbers (0-9)
                if (charCode >= 48 && charCode <= 57) {
                    result += String.fromCharCode(charCode + 0xFEE0);
                }
                // Check for half-width uppercase letters (A-Z)
                else if (charCode >= 65 && charCode <= 90) {
                    result += String.fromCharCode(charCode + 0xFEE0);
                }
                // Check for half-width lowercase letters (a-z)
                else if (charCode >= 97 && charCode <= 122) {
                    result += String.fromCharCode(charCode + 0xFEE0);
                }
                // Keep other characters as they are
                else {
                    result += str[i];
                }
            }
            return result;
        }

        // Convert H1 title text to full-width
        if (h1Element) {
            h1Element.textContent = toFullWidth(h1Element.textContent);
        }
         // Also convert the main title tag
        document.title = toFullWidth(document.title);


        // 替换函数 (Now operates on text potentially containing full-width chars)
        function replaceCensoredWords(text) {
            let processedText = text;
            // 遍历字典中的每一个屏蔽词
            for (const key in censorDictionary) {
                if (censorDictionary.hasOwnProperty(key)) {
                    // 使用 RegExp 进行全局替换，以处理字符串中的所有出现
                    // 'g' flag for global replacement
                    // Escape special regex characters in the key
                    const escapedKey = key.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                    const regex = new RegExp(escapedKey, 'g');
                    processedText = processedText.replace(regex, censorDictionary[key]);
                }
            }
            return processedText;
        }

        // 监听输入框的输入事件
        inputText.addEventListener('input', () => {
            const originalText = inputText.value;
            // 1. Convert to full-width first
            const fullWidthText = toFullWidth(originalText);
            // 2. Then replace censored words
            const replacedText = replaceCensoredWords(fullWidthText);
            outputText.value = replacedText;
        });

        // 监听复制按钮的点击事件
        copyButton.addEventListener('click', () => {
            const textToCopy = outputText.value;
            if (!textToCopy) {
                // Convert alert text to full-width
                 alert(toFullWidth("没有内容可以复制！"));
                return;
            }

            // 使用 navigator.clipboard API 复制文本
            navigator.clipboard.writeText(textToCopy)
                .then(() => {
                    // 复制成功提示
                    const originalButtonText = copyButton.textContent;
                    // Convert button text to full-width
                    copyButton.textContent = toFullWidth('已复制!');
                    copyButton.style.backgroundColor = '#4CAF50'; // 暂时变绿表示成功

                    // 1.5秒后恢复按钮文字和颜色
                    setTimeout(() => {
                        copyButton.textContent = toFullWidth(originalButtonText); // Restore original text (also converted)
                        copyButton.style.backgroundColor = '#76FF33'; // 恢复原色
                    }, 1500);
                })
                .catch(err => {
                    console.error('无法复制文本: ', err);
                     // Convert alert text to full-width
                    alert(toFullWidth('复制失败，您的浏览器可能不支持或权限不足。请尝试手动复制。'));
                });
        });

        // Initialize button text with full-width conversion
        copyButton.textContent = toFullWidth(copyButton.textContent);

         // Also convert labels
         document.querySelectorAll('label').forEach(label => {
             label.textContent = toFullWidth(label.textContent);
         });

    </script>
</body>
</html>
